public void create(String title, String content, Customer customer, int category) {
Post p = new Post();
p.setTitle(title);
p.setContent(content);
p.setLocalDateTime(LocalDateTime.now());
p.setCustomer(customer);
p.setCategory(category);
this.postRepository.save(p);
}

public void modify(Post post, String title, String content) {
post.setTitle(title);
post.setContent(content);
post.setModifyDate(LocalDateTime.now());
this.postRepository.save(post);
}

@PreAuthorize("isAuthenticated()")
@GetMapping("/modify/{id}")
public String postModify(PostForm postForm, @PathVariable("id") Long id, Principal principal, Model model) {
Post post = this.postService.getPost(id);
if(!post.getCustomer().getUsername().equals(principal.getName())) {
throw new ResponseStatusException(HttpStatus.BAD_REQUEST, "수정권한이 없습니다.");
}

postForm.setTitle(post.getTitle());
postForm.setContent(post.getContent());
return "Board/post_form";
}

@PreAuthorize("isAuthenticated()")
@PostMapping("/modify/{id}")
public String postModify(@Valid PostForm postForm, BindingResult bindingResult,
Principal principal, @PathVariable("id") Long id) {
if (bindingResult.hasErrors()) {
return "Board/post_form";
}
Post post = this.postService.getPost(id);
if (!post.getCustomer().getUsername().equals(principal.getName())) {
throw new ResponseStatusException(HttpStatus.BAD_REQUEST, "수정권한이 없습니다.");
}
this.postService.modify(post, postForm.getTitle(), postForm.getContent());
return String.format("redirect:/post/detail/%s", id);
}